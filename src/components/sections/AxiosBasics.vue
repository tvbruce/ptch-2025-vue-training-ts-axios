<template>
  <div class="section-content">
    <!-- ç« ç¯€æ¨™é¡Œ -->
    <div class="section-header">
      <h2>Axios åŸºç¤ä½¿ç”¨</h2>
      <p class="section-description">
        æ·±å…¥å­¸ç¿’ Axios HTTP å®¢æˆ¶ç«¯åº«çš„åŸºç¤ç”¨æ³•ï¼ŒåŒ…æ‹¬å®‰è£é…ç½®ã€HTTP æ–¹æ³•ä½¿ç”¨å’ŒåŸºæœ¬éŒ¯èª¤è™•ç†ã€‚
      </p>
    </div>

    <!-- Fetch API vs Axios æ·±åº¦å°æ¯” -->
    <div class="content-block">
      <h3>âš”ï¸ Fetch API vs Axios æ·±åº¦å°æ¯”</h3>

      <div class="comparison-intro">
        <p>åœ¨é¸æ“‡ HTTP å®¢æˆ¶ç«¯å·¥å…·æ™‚ï¼Œäº†è§£ Fetch API èˆ‡ Axios çš„å·®ç•°è‡³é—œé‡è¦ã€‚æœ¬ç¯€å°‡é€šéå¯¦éš›ç¯„ä¾‹å±•ç¤ºå…©è€…çš„å„ªç¼ºé»ã€‚</p>
      </div>

      <div class="comparison-tabs">
        <div class="tab-buttons">
          <button class="tab-button" :class="{ active: activeComparison === 'basic' }"
            @click="activeComparison = 'basic'">
            åŸºæœ¬è«‹æ±‚å°æ¯”
          </button>
          <button class="tab-button" :class="{ active: activeComparison === 'error' }"
            @click="activeComparison = 'error'">
            éŒ¯èª¤è™•ç†å°æ¯”
          </button>
          <button class="tab-button" :class="{ active: activeComparison === 'config' }"
            @click="activeComparison = 'config'">
            é…ç½®è¤‡é›œåº¦å°æ¯”
          </button>
        </div>

        <div class="tab-content">
          <!-- åŸºæœ¬è«‹æ±‚å°æ¯” -->
          <div v-show="activeComparison === 'basic'" class="comparison-grid">
            <div class="fetch-example">
              <h4>âŒ ä½¿ç”¨ Fetch APIï¼ˆç¹ç‘£ï¼‰</h4>
              <CodeBlock title="Fetch API åŸºæœ¬ GET è«‹æ±‚" :code="fetchBasicCode" language="typescript"
                explanation="Fetch API éœ€è¦æ‰‹å‹•è™•ç† JSON è½‰æ›å’Œç‹€æ…‹æª¢æŸ¥" />
            </div>

            <div class="axios-example">
              <h4>âœ… ä½¿ç”¨ Axiosï¼ˆç°¡æ½”ï¼‰</h4>
              <CodeBlock title="Axios åŸºæœ¬ GET è«‹æ±‚" :code="axiosBasicCode" language="typescript"
                explanation="Axios è‡ªå‹•è™•ç† JSON å’Œç‹€æ…‹æª¢æŸ¥ï¼Œä»£ç¢¼æ›´ç°¡æ½”" />
            </div>
          </div>

          <!-- éŒ¯èª¤è™•ç†å°æ¯” -->
          <div v-show="activeComparison === 'error'" class="comparison-grid">
            <div class="fetch-example">
              <h4>âŒ Fetch éŒ¯èª¤è™•ç†ï¼ˆè¤‡é›œï¼‰</h4>
              <CodeBlock title="Fetch API è¤‡é›œéŒ¯èª¤è™•ç†" :code="fetchErrorCode" language="typescript"
                explanation="Fetch éœ€è¦æ‰‹å‹•æª¢æŸ¥å„ç¨®éŒ¯èª¤æƒ…æ³" />
            </div>

            <div class="axios-example">
              <h4>âœ… Axios éŒ¯èª¤è™•ç†ï¼ˆå„ªé›…ï¼‰</h4>
              <CodeBlock title="Axios ç°¡æ½”éŒ¯èª¤è™•ç†" :code="axiosErrorCode" language="typescript"
                explanation="Axios æä¾›çµ±ä¸€çš„éŒ¯èª¤è™•ç†å’Œè±å¯Œçš„éŒ¯èª¤è³‡è¨Š" />
            </div>
          </div>

          <!-- é…ç½®è¤‡é›œåº¦å°æ¯” -->
          <div v-show="activeComparison === 'config'" class="comparison-grid">
            <div class="fetch-example">
              <h4>âŒ Fetch é€²éšé…ç½®ï¼ˆå†—é•·ï¼‰</h4>
              <CodeBlock title="Fetch API é€²éšé…ç½®" :code="fetchConfigCode" language="typescript"
                explanation="Fetch éœ€è¦å¤§é‡æ¨¡æ¿ä»£ç¢¼ä¾†å¯¦ç¾é€²éšåŠŸèƒ½" />
            </div>

            <div class="axios-example">
              <h4>âœ… Axios é€²éšé…ç½®ï¼ˆç›´è§€ï¼‰</h4>
              <CodeBlock title="Axios é€²éšé…ç½®" :code="axiosConfigCode" language="typescript"
                explanation="Axios æä¾›è±å¯Œçš„é…ç½®é¸é …å’Œæ””æˆªå™¨æ©Ÿåˆ¶" />
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- æ•ˆç‡èˆ‡ç¶­è­·æ€§åˆ†æ -->
    <div class="content-block">
      <h3>ğŸ“Š æ•ˆç‡èˆ‡ç¶­è­·æ€§åˆ†æ</h3>

      <div class="metrics-grid">
        <div class="metric-card fetch-metric">
          <h4>Fetch API</h4>
          <div class="metric-item">
            <span class="metric-label">ä»£ç¢¼è¡Œæ•¸</span>
            <span class="metric-value high">+40%</span>
          </div>
          <div class="metric-item">
            <span class="metric-label">éŒ¯èª¤è™•ç†è¤‡é›œåº¦</span>
            <span class="metric-value high">é«˜</span>
          </div>
          <div class="metric-item">
            <span class="metric-label">å­¸ç¿’æ›²ç·š</span>
            <span class="metric-value medium">ä¸­ç­‰</span>
          </div>
          <div class="metric-item">
            <span class="metric-label">Bundle å¤§å°</span>
            <span class="metric-value low">0KBï¼ˆå…§å»ºï¼‰</span>
          </div>
        </div>

        <div class="metric-card axios-metric">
          <h4>Axios</h4>
          <div class="metric-item">
            <span class="metric-label">ä»£ç¢¼è¡Œæ•¸</span>
            <span class="metric-value low">åŸºæº–</span>
          </div>
          <div class="metric-item">
            <span class="metric-label">éŒ¯èª¤è™•ç†è¤‡é›œåº¦</span>
            <span class="metric-value low">ä½</span>
          </div>
          <div class="metric-item">
            <span class="metric-label">å­¸ç¿’æ›²ç·š</span>
            <span class="metric-value low">å¹³ç·©</span>
          </div>
          <div class="metric-item">
            <span class="metric-label">Bundle å¤§å°</span>
            <span class="metric-value medium">~13KB</span>
          </div>
        </div>
      </div>
    </div>

    <!-- C# HttpClient å°æ¯” -->
    <div class="content-block">
      <h3>ğŸ”· èˆ‡ C# HttpClient çš„ç›¸ä¼¼æ€§</h3>

      <div class="csharp-comparison">
        <p>å°æ–¼æœ‰å…¶ä»–èªè¨€ç¶“é©—çš„é–‹ç™¼äººå“¡ï¼ŒAxios çš„è¨­è¨ˆç†å¿µèˆ‡è¨±å¤šèªè¨€çš„ HTTP å®¢æˆ¶ç«¯éå¸¸ç›¸ä¼¼ï¼š</p>

        <div class="similarity-grid">
          <div class="similarity-item">
            <h4>ğŸ¯ ç›¸ä¼¼é»</h4>
            <ul>
              <li>çµ±ä¸€çš„å®¢æˆ¶ç«¯å¯¦ä¾‹ç®¡ç†</li>
              <li>è±å¯Œçš„é…ç½®é¸é …</li>
              <li>æ””æˆªå™¨æ¦‚å¿µï¼ˆé¡ä¼¼ DelegatingHandlerï¼‰</li>
              <li>è‡ªå‹•åºåˆ—åŒ–/ååºåˆ—åŒ–</li>
              <li>å®Œå–„çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶</li>
            </ul>
          </div>

          <div class="similarity-item">
            <h4>ğŸ’¡ å­¸ç¿’å»ºè­°</h4>
            <ul>
              <li>å°‡ Axios å¯¦ä¾‹è¦–ç‚º HttpClient</li>
              <li>æ””æˆªå™¨ç­‰åŒæ–¼ HTTP ä¸­ä»‹è»Ÿé«”</li>
              <li>é…ç½®å°è±¡é¡ä¼¼æ–¼ HttpClientHandler</li>
              <li>Promise å°æ‡‰æ–¼ Task&lt;HttpResponseMessage&gt;</li>
            </ul>
          </div>
        </div>

        <CodeBlock title="C# HttpClient vs Axios æ¦‚å¿µå°ç…§" :code="csharpComparisonCode" language="typescript"
          explanation="å±•ç¤º C# HttpClient èˆ‡ Axios çš„æ¦‚å¿µå°æ‡‰é—œä¿‚" />
      </div>
    </div>

    <!-- Axios ä»‹ç´¹ -->
    <div class="content-block">
      <h3>ğŸš€ Axios æ·±å…¥ä»‹ç´¹</h3>
      <div class="intro-card">
        <p>
          ç¶“éå°æ¯”åˆ†æï¼Œæˆ‘å€‘å¯ä»¥çœ‹å‡º Axios åœ¨é–‹ç™¼æ•ˆç‡å’Œä»£ç¢¼ç¶­è­·æ€§æ–¹é¢çš„å„ªå‹¢ã€‚
          ç¾åœ¨è®“æˆ‘å€‘æ·±å…¥äº†è§£ Axios çš„æ ¸å¿ƒåŠŸèƒ½ã€‚
        </p>

        <div class="features-grid">
          <div class="feature-item">
            <div class="feature-icon">ğŸ”§</div>
            <h4>è±å¯Œçš„é…ç½®</h4>
            <p>æ”¯æ´è«‹æ±‚æ””æˆªå™¨ã€éŸ¿æ‡‰æ””æˆªå™¨ã€è¶…æ™‚è¨­å®šç­‰</p>
          </div>
          <div class="feature-item">
            <div class="feature-icon">ğŸ›¡ï¸</div>
            <h4>è‡ªå‹•éŒ¯èª¤è™•ç†</h4>
            <p>è‡ªå‹• JSON è§£æå’Œå®Œå–„çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶</p>
          </div>
          <div class="feature-item">
            <div class="feature-icon">ğŸ”„</div>
            <h4>è«‹æ±‚ç®¡ç†</h4>
            <p>æ”¯æ´è«‹æ±‚å–æ¶ˆã€é‡è©¦æ©Ÿåˆ¶å’Œä¸¦ç™¼æ§åˆ¶</p>
          </div>
          <div class="feature-item">
            <div class="feature-icon">ğŸ“±</div>
            <h4>è·¨å¹³å°å…¼å®¹</h4>
            <p>åŒæ™‚æ”¯æ´ç€è¦½å™¨å’Œ Node.js ç’°å¢ƒ</p>
          </div>
        </div>
      </div>
    </div>

    <!-- å®‰è£èˆ‡åŸºæœ¬è¨­å®š -->
    <div class="content-block">
      <h3>ğŸ“¦ å®‰è£èˆ‡åŸºæœ¬è¨­å®š</h3>

      <CodeBlock title="Axios å®‰è£" :code="installationCode" language="bash" explanation="å®‰è£ Axios å’Œå…¶ TypeScript å‹åˆ¥å®šç¾©" />

      <CodeBlock title="åŸºæœ¬é…ç½®" :code="basicConfigCode" language="typescript" explanation="å‰µå»º Axios å¯¦ä¾‹ä¸¦è¨­å®šåŸºæœ¬é…ç½®é¸é …"
        :runnable="true" @run="runBasicConfig" />
    </div>

    <!-- HTTP æ–¹æ³•ä½¿ç”¨ -->
    <div class="content-block">
      <h3>ğŸŒ HTTP æ–¹æ³•ä½¿ç”¨</h3>

      <div class="method-tabs">
        <div class="tab-buttons">
          <button v-for="method in httpMethods" :key="method.name" class="tab-button"
            :class="{ active: activeMethod === method.name }" @click="activeMethod = method.name">
            {{ method.name.toUpperCase() }}
          </button>
        </div>

        <div class="tab-content">
          <div v-for="method in httpMethods" :key="method.name" v-show="activeMethod === method.name">
            <div class="method-description">
              <h4>{{ method.title }}</h4>
              <p>{{ method.description }}</p>
            </div>

            <CodeBlock :title="`${method.name.toUpperCase()} è«‹æ±‚ç¯„ä¾‹`" :code="method.code" language="typescript"
              :explanation="method.explanation" :runnable="true" @run="runHttpMethod(method.name)" />
          </div>
        </div>
      </div>
    </div>

    <!-- éŒ¯èª¤è™•ç† -->
    <div class="content-block">
      <h3>âš ï¸ éŒ¯èª¤è™•ç†</h3>

      <CodeBlock title="å®Œæ•´çš„éŒ¯èª¤è™•ç†" :code="errorHandlingCode" language="typescript"
        explanation="å¯¦ä½œå®Œå–„çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶ï¼ŒåŒ…æ‹¬ç¶²è·¯éŒ¯èª¤ã€HTTP éŒ¯èª¤å’Œè¶…æ™‚è™•ç†" :runnable="true" @run="runErrorHandling" />
    </div>

    <!-- å¯¦éš›æ¼”ç¤º -->
    <div class="content-block">
      <h3>ğŸ¯ å¯¦éš›æ¼”ç¤º</h3>

      <div class="demo-section">
        <h4>æ¸¬è©¦ API è«‹æ±‚</h4>
        <div class="api-config-info">
          <p><strong>ğŸ”§ ç•¶å‰é…ç½®ï¼š</strong></p>
          <ul>
            <li>ç’°å¢ƒ: {{ apiConfig.environment }}</li>
            <li>API åŸºç¤ URL: {{ apiConfig.baseURL }}</li>
            <li>ä½¿ç”¨ JSON Server: {{ apiConfig.useJSONServer ? 'æ˜¯' : 'å¦' }}</li>
          </ul>
          <p v-if="apiConfig.useJSONServer" class="json-server-note">
            ğŸ“ <strong>æ³¨æ„ï¼š</strong>è«‹ç¢ºä¿ JSON Server æ­£åœ¨é‹è¡Œï¼š<code>npm run json-server</code>
          </p>
        </div>
        <p>é»æ“ŠæŒ‰éˆ•æ¸¬è©¦ä¸åŒçš„ Axios åŠŸèƒ½ï¼š</p>

        <div class="demo-buttons">
          <button class="demo-btn" @click="testGetRequest" :disabled="loading">
            {{ loading && currentTest === 'get' ? 'è«‹æ±‚ä¸­...' : 'æ¸¬è©¦ GET è«‹æ±‚' }}
          </button>
          <button class="demo-btn" @click="testPostRequest" :disabled="loading">
            {{ loading && currentTest === 'post' ? 'å‰µå»ºä¸­...' : 'æ¸¬è©¦ POST è«‹æ±‚' }}
          </button>
          <button class="demo-btn" @click="testErrorRequest" :disabled="loading">
            {{ loading && currentTest === 'error' ? 'æ¸¬è©¦ä¸­...' : 'æ¸¬è©¦éŒ¯èª¤è™•ç†' }}
          </button>
          <button class="demo-btn" @click="testTimeout" :disabled="loading">
            {{ loading && currentTest === 'timeout' ? 'æ¸¬è©¦ä¸­...' : 'æ¸¬è©¦è¶…æ™‚' }}
          </button>
        </div>

        <div v-if="demoResult" class="demo-result">
          <h5>åŸ·è¡Œçµæœï¼š</h5>
          <pre>{{ demoResult }}</pre>
        </div>
      </div>
    </div>

    <!-- ç·´ç¿’å€åŸŸ -->
    <div class="content-block">
      <h3>ğŸ’» å‹•æ‰‹ç·´ç¿’</h3>

      <div class="exercise-card">
        <h4>ç·´ç¿’ï¼šå»ºç«‹ç”¨æˆ¶ç®¡ç†ç³»çµ±</h4>
        <p>å¯¦ä½œä¸€å€‹å®Œæ•´çš„ç”¨æˆ¶ç®¡ç† CRUD ç³»çµ±ï¼ŒåŒ…å«ä»¥ä¸‹åŠŸèƒ½ï¼š</p>

        <ul class="exercise-requirements">
          <li>ç²å–æ‰€æœ‰ç”¨æˆ¶åˆ—è¡¨</li>
          <li>æ ¹æ“š ID ç²å–å–®å€‹ç”¨æˆ¶</li>
          <li>å‰µå»ºæ–°ç”¨æˆ¶</li>
          <li>æ›´æ–°ç”¨æˆ¶è³‡è¨Š</li>
          <li>åˆªé™¤ç”¨æˆ¶</li>
          <li>é©ç•¶çš„éŒ¯èª¤è™•ç†</li>
        </ul>

        <CodeBlock title="ç·´ç¿’æ¨¡æ¿" :code="exerciseTemplate" language="typescript" explanation="åœ¨é€™å€‹æ¨¡æ¿åŸºç¤ä¸Šå¯¦ä½œå®Œæ•´çš„ç”¨æˆ¶ç®¡ç†åŠŸèƒ½" />

        <button class="start-exercise-btn" @click="showExerciseSolution = !showExerciseSolution">
          {{ showExerciseSolution ? 'éš±è—' : 'æŸ¥çœ‹' }}åƒè€ƒè§£ç­”
        </button>

        <div v-if="showExerciseSolution" class="exercise-solution">
          <CodeBlock title="åƒè€ƒè§£ç­”" :code="exerciseSolution" language="typescript"
            explanation="é€™æ˜¯ä¸€å€‹åƒè€ƒå¯¦ä½œï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Axios å»ºç«‹å‹åˆ¥å®‰å…¨çš„ç”¨æˆ¶ç®¡ç†ç³»çµ±" />
        </div>
      </div>
    </div>

    <!-- ç« ç¯€ç¸½çµ -->
    <div class="content-block">
      <h3>ğŸ“‹ ç« ç¯€ç¸½çµ</h3>

      <div class="summary-card">
        <h4>æœ¬ç« ç¯€å­¸åˆ°çš„é‡é»ï¼š</h4>
        <ul class="summary-list">
          <li>Axios çš„å„ªå‹¢å’Œç‰¹è‰²åŠŸèƒ½</li>
          <li>å¦‚ä½•å®‰è£å’Œé…ç½® Axios</li>
          <li>å„ç¨® HTTP æ–¹æ³•çš„ä½¿ç”¨æ–¹å¼</li>
          <li>å®Œå–„çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶</li>
          <li>å¯¦éš›çš„ API è«‹æ±‚æ¼”ç¤º</li>
        </ul>

        <div class="next-steps">
          <h4>ä¸‹ä¸€æ­¥å­¸ç¿’ï¼š</h4>
          <p>åœ¨ä¸‹ä¸€ç« ç¯€ä¸­ï¼Œæˆ‘å€‘å°‡å­¸ç¿’å¦‚ä½•åœ¨ TypeScript å°ˆæ¡ˆä¸­ä½¿ç”¨ Axiosï¼ŒåŒ…æ‹¬å‹åˆ¥å®‰å…¨ã€æ””æˆªå™¨ã€å’Œé€²éšåŠŸèƒ½ã€‚</p>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'
import CodeBlock from '@/components/common/CodeBlock.vue'
import { userAPI, testAPI, apiConfig } from '@/utils/apiClient'

interface SectionData {
  title: string
}

defineProps<{
  section?: SectionData
}>()

const activeMethod = ref('get')
const activeComparison = ref('basic')
const loading = ref(false)
const currentTest = ref('')
const demoResult = ref('')
const showExerciseSolution = ref(false)

// Fetch vs Axios å°æ¯”ä»£ç¢¼ç¯„ä¾‹
const fetchBasicCode = `// Fetch API - éœ€è¦æ›´å¤šæ‰‹å‹•è™•ç†
async function getUserData(id: number): Promise<User> {
    try {
        const response = await fetch(\`/api/users/\${id}\`)

        // æ‰‹å‹•æª¢æŸ¥ HTTP ç‹€æ…‹
        if (!response.ok) {
            throw new Error(\`HTTP error! status: \${response.status}\`)
        }

        // æ‰‹å‹•è§£æ JSON
        const data = await response.json()
        return data
    } catch (error) {
        console.error('Request failed:', error)
        throw error
    }
}`

const axiosBasicCode = `// Axios - è‡ªå‹•è™•ç†å¸¸è¦‹ä»»å‹™
async function getUserData(id: number): Promise<User> {
    try {
        const response = await axios.get<User>(\`/api/users/\${id}\`)
        return response.data  // è‡ªå‹•è§£æçš„ JSON
    } catch (error) {
        console.error('Request failed:', error)
        throw error
    }
}`

const fetchErrorCode = `// Fetch API - è¤‡é›œçš„éŒ¯èª¤è™•ç†
async function createUser(userData: CreateUserRequest): Promise<User> {
    try {
        const response = await fetch('/api/users', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(userData)
        })

        // éœ€è¦æ‰‹å‹•æª¢æŸ¥å„ç¨®ç‹€æ…‹ç¢¼
        if (response.status === 400) {
            const errorData = await response.json()
            throw new ValidationError(errorData.message)
        }

        if (response.status === 401) {
            throw new AuthenticationError('Unauthorized')
        }

        if (response.status === 403) {
            throw new AuthorizationError('Forbidden')
        }

        if (response.status >= 500) {
            throw new ServerError('Internal server error')
        }

        if (!response.ok) {
            throw new Error(\`Unknown error: \${response.status}\`)
        }

        return await response.json()
    } catch (error) {
        if (error instanceof TypeError) {
            throw new NetworkError('Network connection failed')
        }
        throw error
    }
}`

const axiosErrorCode = `// Axios - çµ±ä¸€å„ªé›…çš„éŒ¯èª¤è™•ç†
async function createUser(userData: CreateUserRequest): Promise<User> {
    try {
        const response = await axios.post<User>('/api/users', userData)
        return response.data
    } catch (error) {
        if (axios.isAxiosError(error)) {
            const status = error.response?.status
            const message = error.response?.data?.message || error.message

            switch (status) {
                case 400:
                    throw new ValidationError(message)
                case 401:
                    throw new AuthenticationError('Unauthorized')
                case 403:
                    throw new AuthorizationError('Forbidden')
                case 500:
                    throw new ServerError('Internal server error')
                default:
                    throw new Error(\`Request failed: \${message}\`)
            }
        }
        throw error
    }
}`

const fetchConfigCode = `// Fetch API - éœ€è¦å¤§é‡è¨­å®šä»£ç¢¼
class FetchApiClient {
    private baseURL = '/api'
    private defaultHeaders = {
        'Content-Type': 'application/json'
    }

    async request<T>(endpoint: string, options: RequestInit = {}): Promise<T> {
        const url = \`\${this.baseURL}\${endpoint}\`

        // æ‰‹å‹•çµ„åˆ headers
        const headers = {
            ...this.defaultHeaders,
            ...options.headers
        }

        // æ‰‹å‹•æ·»åŠ èªè­‰
        const token = localStorage.getItem('token')
        if (token) {
            headers.Authorization = \`Bearer \${token}\`
        }

        try {
            const response = await fetch(url, {
                ...options,
                headers,
                // æ‰‹å‹•è¨­å®šè¶…æ™‚
                signal: AbortSignal.timeout(10000)
            })

            if (!response.ok) {
                throw new Error(\`HTTP \${response.status}: \${response.statusText}\`)
            }

            const contentType = response.headers.get('content-type')
            if (contentType?.includes('application/json')) {
                return await response.json()
            } else {
                return await response.text() as any
            }
        } catch (error) {
            // æ‰‹å‹•è™•ç†å„ç¨®éŒ¯èª¤é¡å‹
            if (error instanceof DOMException && error.name === 'TimeoutError') {
                throw new Error('Request timeout')
            }
            throw error
        }
    }
}`

const axiosConfigCode = `// Axios - ç°¡æ½”çš„è¨­å®šå’Œå¼·å¤§åŠŸèƒ½
const apiClient = axios.create({
    baseURL: '/api',
    timeout: 10000,
    headers: {
        'Content-Type': 'application/json'
    }
})

// è«‹æ±‚æ””æˆªå™¨ - è‡ªå‹•æ·»åŠ èªè­‰
apiClient.interceptors.request.use(config => {
    const token = localStorage.getItem('token')
    if (token && config.headers) {
        config.headers.Authorization = \`Bearer \${token}\`
    }
    return config
})

// éŸ¿æ‡‰æ””æˆªå™¨ - çµ±ä¸€éŒ¯èª¤è™•ç†
apiClient.interceptors.response.use(
    response => response,
    error => {
        if (error.response?.status === 401) {
            // è‡ªå‹•è™•ç†èªè­‰éæœŸ
            localStorage.removeItem('token')
            window.location.href = '/login'
        }
        return Promise.reject(error)
    }
)

// ä½¿ç”¨è®Šå¾—éå¸¸ç°¡å–®
const getUsers = () => apiClient.get<User[]>('/users')
const createUser = (data: CreateUserRequest) => apiClient.post<User>('/users', data)`

const csharpComparisonCode = `/*
C# HttpClient æ¦‚å¿µå°ç…§ï¼š

// C# HttpClient è¨­å®š
var client = new HttpClient()
{
    BaseAddress = new Uri("https://api.example.com/"),
    Timeout = TimeSpan.FromSeconds(30)
};
client.DefaultRequestHeaders.Add("Authorization", "Bearer " + token);

// TypeScript Axios ç­‰åƒ¹è¨­å®š
const client = axios.create({
    baseURL: 'https://api.example.com/',
    timeout: 30000,
    headers: {
        'Authorization': \`Bearer \${token}\`
    }
});

// C# ç™¼é€è«‹æ±‚
var response = await client.GetAsync("/users");
var users = await response.Content.ReadFromJsonAsync<User[]>();

// TypeScript Axios ç­‰åƒ¹è«‹æ±‚
const response = await client.get<User[]>('/users');
const users = response.data;

// C# ä¸­ä»‹è»Ÿé«” (DelegatingHandler)
public class AuthHandler : DelegatingHandler
{
    protected override async Task<HttpResponseMessage> SendAsync(
        HttpRequestMessage request, CancellationToken cancellationToken)
    {
        // æ·»åŠ èªè­‰é‚è¼¯
        return await base.SendAsync(request, cancellationToken);
    }
}

// TypeScript Axios æ””æˆªå™¨ï¼ˆç›¸åŒæ¦‚å¿µï¼‰
client.interceptors.request.use(config => {
    // æ·»åŠ èªè­‰é‚è¼¯
    return config;
});
*/

// å¯¦éš›å°ç…§ç¯„ä¾‹
interface User {
    id: number;
    name: string;
    email: string;
}

// ç›¸ä¼¼çš„ API å®¢æˆ¶ç«¯è¨­è¨ˆæ¨¡å¼
class TypeSafeApiClient {
    private client = axios.create({
        baseURL: '/api',
        timeout: 10000
    });

    // é¡ä¼¼ C# çš„æ³›å‹æ–¹æ³•
    async get<T>(endpoint: string): Promise<T> {
        const response = await this.client.get<T>(endpoint);
        return response.data;
    }

    async post<TRequest, TResponse>(endpoint: string, data: TRequest): Promise<TResponse> {
        const response = await this.client.post<TResponse>(endpoint, data);
        return response.data;
    }
}`

const installationCode = `# ä½¿ç”¨ npm å®‰è£
npm install axios

# å®‰è£ TypeScript å‹åˆ¥å®šç¾©ï¼ˆå¦‚æœéœ€è¦ï¼‰
npm install @types/axios --save-dev

# ä½¿ç”¨ yarn å®‰è£
yarn add axios`

const basicConfigCode = `import axios from 'axios';

// å‰µå»º Axios å¯¦ä¾‹
const apiClient = axios.create({
  baseURL: 'https://api.example.com',
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json',
    'Accept': 'application/json'
  }
});

// åŸºæœ¬è«‹æ±‚ç¯„ä¾‹
async function getUsers() {
  try {
    const response = await apiClient.get('/users');
    console.log('ç”¨æˆ¶åˆ—è¡¨:', response.data);
    return response.data;
  } catch (error) {
    console.error('è«‹æ±‚å¤±æ•—:', error);
    throw error;
  }
}`

const httpMethods = ref([
  {
    name: 'get',
    title: 'GET è«‹æ±‚ - ç²å–è³‡æ–™',
    description: 'GET æ–¹æ³•ç”¨æ–¼å¾ä¼ºæœå™¨ç²å–è³‡æ–™ï¼Œæ˜¯æœ€å¸¸ç”¨çš„ HTTP æ–¹æ³•ä¹‹ä¸€ã€‚',
    code: `// GET è«‹æ±‚ - ç²å–æ‰€æœ‰ç”¨æˆ¶
const getUsers = async () => {
  try {
    const response = await apiClient.get('/users');
    return response.data;
  } catch (error) {
    console.error('ç²å–ç”¨æˆ¶å¤±æ•—:', error);
    throw error;
  }
};

// GET è«‹æ±‚ - æ ¹æ“š ID ç²å–å–®å€‹ç”¨æˆ¶
const getUser = async (id: number) => {
  try {
    const response = await apiClient.get(\`/users/\${id}\`);
    return response.data;
  } catch (error) {
    console.error(\`ç²å–ç”¨æˆ¶ \${id} å¤±æ•—:\`, error);
    throw error;
  }
};

// GET è«‹æ±‚ - å¸¶æŸ¥è©¢åƒæ•¸
const getUsersWithParams = async (page: number, limit: number) => {
  try {
    const response = await apiClient.get('/users', {
      params: { page, limit }
    });
    return response.data;
  } catch (error) {
    console.error('ç²å–ç”¨æˆ¶åˆ—è¡¨å¤±æ•—:', error);
    throw error;
  }
};`,
    explanation: 'GET è«‹æ±‚ä¸æœƒä¿®æ”¹ä¼ºæœå™¨è³‡æ–™ï¼Œé©ç”¨æ–¼è³‡æ–™æŸ¥è©¢æ“ä½œ'
  },
  {
    name: 'post',
    title: 'POST è«‹æ±‚ - å‰µå»ºè³‡æ–™',
    description: 'POST æ–¹æ³•ç”¨æ–¼å‘ä¼ºæœå™¨æäº¤æ–°è³‡æ–™ï¼Œé€šå¸¸ç”¨æ–¼å‰µå»ºæ–°çš„è³‡æºã€‚',
    code: `// POST è«‹æ±‚ - å‰µå»ºæ–°ç”¨æˆ¶
interface CreateUserRequest {
  name: string;
  email: string;
}

const createUser = async (userData: CreateUserRequest) => {
  try {
    const response = await apiClient.post('/users', userData);
    console.log('ç”¨æˆ¶å‰µå»ºæˆåŠŸ:', response.data);
    return response.data;
  } catch (error) {
    console.error('å‰µå»ºç”¨æˆ¶å¤±æ•—:', error);
    throw error;
  }
};

// POST è«‹æ±‚ - ä¸Šå‚³æª”æ¡ˆ
const uploadFile = async (file: File) => {
  const formData = new FormData();
  formData.append('file', file);

  try {
    const response = await apiClient.post('/upload', formData, {
      headers: {
        'Content-Type': 'multipart/form-data'
      }
    });
    return response.data;
  } catch (error) {
    console.error('æª”æ¡ˆä¸Šå‚³å¤±æ•—:', error);
    throw error;
  }
};`,
    explanation: 'POST è«‹æ±‚æœƒåœ¨ä¼ºæœå™¨ä¸Šå‰µå»ºæ–°è³‡æºï¼Œè«‹æ±‚é«”åŒ…å«è¦å‰µå»ºçš„è³‡æ–™'
  },
  {
    name: 'put',
    title: 'PUT è«‹æ±‚ - æ›´æ–°è³‡æ–™',
    description: 'PUT æ–¹æ³•ç”¨æ–¼å®Œæ•´æ›´æ–°ç¾æœ‰è³‡æºï¼Œæœƒæ›¿æ›æ•´å€‹è³‡æºã€‚',
    code: `// PUT è«‹æ±‚ - å®Œæ•´æ›´æ–°ç”¨æˆ¶
interface UpdateUserRequest {
  name: string;
  email: string;
  role?: string;
}

const updateUser = async (id: number, userData: UpdateUserRequest) => {
  try {
    const response = await apiClient.put(\`/users/\${id}\`, userData);
    console.log('ç”¨æˆ¶æ›´æ–°æˆåŠŸ:', response.data);
    return response.data;
  } catch (error) {
    console.error(\`æ›´æ–°ç”¨æˆ¶ \${id} å¤±æ•—:\`, error);
    throw error;
  }
};

// PUT è«‹æ±‚ - æ›¿æ›æ•´å€‹è³‡æº
const replaceUser = async (id: number, newUserData: CreateUserRequest) => {
  try {
    const response = await apiClient.put(\`/users/\${id}\`, newUserData);
    return response.data;
  } catch (error) {
    console.error('æ›¿æ›ç”¨æˆ¶å¤±æ•—:', error);
    throw error;
  }
};`,
    explanation: 'PUT è«‹æ±‚æœƒå®Œå…¨æ›¿æ›ç›®æ¨™è³‡æºï¼Œé©ç”¨æ–¼å®Œæ•´æ›´æ–°æ“ä½œ'
  },
  {
    name: 'patch',
    title: 'PATCH è«‹æ±‚ - éƒ¨åˆ†æ›´æ–°',
    description: 'PATCH æ–¹æ³•ç”¨æ–¼éƒ¨åˆ†æ›´æ–°ç¾æœ‰è³‡æºï¼Œåªä¿®æ”¹æŒ‡å®šçš„æ¬„ä½ã€‚',
    code: `// PATCH è«‹æ±‚ - éƒ¨åˆ†æ›´æ–°ç”¨æˆ¶
const patchUser = async (id: number, updates: Partial<UpdateUserRequest>) => {
  try {
    const response = await apiClient.patch(\`/users/\${id}\`, updates);
    console.log('ç”¨æˆ¶éƒ¨åˆ†æ›´æ–°æˆåŠŸ:', response.data);
    return response.data;
  } catch (error) {
    console.error(\`éƒ¨åˆ†æ›´æ–°ç”¨æˆ¶ \${id} å¤±æ•—:\`, error);
    throw error;
  }
};

// ç¯„ä¾‹ï¼šåªæ›´æ–°ç”¨æˆ¶åç¨±
const updateUserName = async (id: number, name: string) => {
  return patchUser(id, { name });
};

// ç¯„ä¾‹ï¼šåªæ›´æ–°ç”¨æˆ¶éƒµç®±
const updateUserEmail = async (id: number, email: string) => {
  return patchUser(id, { email });
};`,
    explanation: 'PATCH è«‹æ±‚åªæ›´æ–°æŒ‡å®šçš„æ¬„ä½ï¼Œé©ç”¨æ–¼éƒ¨åˆ†æ›´æ–°æ“ä½œ'
  },
  {
    name: 'delete',
    title: 'DELETE è«‹æ±‚ - åˆªé™¤è³‡æ–™',
    description: 'DELETE æ–¹æ³•ç”¨æ–¼åˆªé™¤ä¼ºæœå™¨ä¸Šçš„è³‡æºã€‚',
    code: `// DELETE è«‹æ±‚ - åˆªé™¤ç”¨æˆ¶
const deleteUser = async (id: number) => {
  try {
    const response = await apiClient.delete(\`/users/\${id}\`);
    console.log(\`ç”¨æˆ¶ \${id} åˆªé™¤æˆåŠŸ\`);
    return response.data;
  } catch (error) {
    console.error(\`åˆªé™¤ç”¨æˆ¶ \${id} å¤±æ•—:\`, error);
    throw error;
  }
};

// DELETE è«‹æ±‚ - æ‰¹é‡åˆªé™¤
const deleteMultipleUsers = async (userIds: number[]) => {
  try {
    const response = await apiClient.delete('/users', {
      data: { ids: userIds }
    });
    console.log(\`æˆåŠŸåˆªé™¤ \${userIds.length} å€‹ç”¨æˆ¶\`);
    return response.data;
  } catch (error) {
    console.error('æ‰¹é‡åˆªé™¤ç”¨æˆ¶å¤±æ•—:', error);
    throw error;
  }
};

// DELETE è«‹æ±‚ - è»Ÿåˆªé™¤
const softDeleteUser = async (id: number) => {
  return patchUser(id, { isDeleted: true });
};`,
    explanation: 'DELETE è«‹æ±‚æœƒå¾ä¼ºæœå™¨åˆªé™¤æŒ‡å®šè³‡æºï¼Œæ“ä½œä¸å¯é€†'
  }
])

const errorHandlingCode = `import axios, { AxiosError } from 'axios';

interface ApiError {
  message: string;
  code: string;
  status: number;
}

// å®Œæ•´çš„éŒ¯èª¤è™•ç†å‡½æ•¸
const handleApiError = (error: AxiosError): ApiError => {
  if (error.response) {
    // ä¼ºæœå™¨å›æ‡‰äº†éŒ¯èª¤ç‹€æ…‹ç¢¼
    return {
      message: error.response.data?.message || 'ä¼ºæœå™¨éŒ¯èª¤',
      code: error.response.data?.code || 'SERVER_ERROR',
      status: error.response.status
    };
  } else if (error.request) {
    // è«‹æ±‚å·²ç™¼å‡ºä½†æ²’æœ‰æ”¶åˆ°å›æ‡‰
    return {
      message: 'ç¶²è·¯éŒ¯èª¤ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£æ¥',
      code: 'NETWORK_ERROR',
      status: 0
    };
  } else {
    // å…¶ä»–éŒ¯èª¤
    return {
      message: error.message || 'æœªçŸ¥éŒ¯èª¤',
      code: 'UNKNOWN_ERROR',
      status: 0
    };
  }
};

// ä½¿ç”¨éŒ¯èª¤è™•ç†çš„ API å‡½æ•¸
const safeApiCall = async <T>(apiCall: () => Promise<T>): Promise<T> => {
  try {
    return await apiCall();
  } catch (error) {
    if (axios.isAxiosError(error)) {
      const apiError = handleApiError(error);
      console.error('API éŒ¯èª¤:', apiError);

      // æ ¹æ“šéŒ¯èª¤é¡å‹æ¡å–ä¸åŒè¡Œå‹•
      switch (apiError.status) {
        case 401:
          // æœªæˆæ¬Šï¼Œé‡æ–°å°å‘ç™»å…¥é 
          window.location.href = '/login';
          break;
        case 403:
          // ç¦æ­¢å­˜å–
          alert('æ‚¨æ²’æœ‰æ¬Šé™åŸ·è¡Œæ­¤æ“ä½œ');
          break;
        case 404:
          // è³‡æºä¸å­˜åœ¨
          alert('è«‹æ±‚çš„è³‡æºä¸å­˜åœ¨');
          break;
        case 500:
          // ä¼ºæœå™¨éŒ¯èª¤
          alert('ä¼ºæœå™¨éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦');
          break;
        default:
          alert(apiError.message);
      }

      throw apiError;
    }

    throw error;
  }
};

// ä½¿ç”¨ç¯„ä¾‹
const getUserSafely = async (id: number) => {
  return safeApiCall(() => apiClient.get(\`/users/\${id}\`));
};`

const exerciseTemplate = `interface User {
  id: number;
  name: string;
  email: string;
}

interface CreateUserRequest {
  name: string;
  email: string;
}

interface UpdateUserRequest {
  name?: string;
  email?: string;
}

class UserService {
  private apiClient = axios.create({
    baseURL: '/api',
    timeout: 5000
  });

  // TODO: å¯¦ä½œ getAllUsers æ–¹æ³•
  async getAllUsers(): Promise<User[]> {
    // åœ¨é€™è£¡å¯¦ä½œ
  }

  // TODO: å¯¦ä½œ getUser æ–¹æ³•
  async getUser(id: number): Promise<User> {
    // åœ¨é€™è£¡å¯¦ä½œ
  }

  // TODO: å¯¦ä½œ createUser æ–¹æ³•
  async createUser(userData: CreateUserRequest): Promise<User> {
    // åœ¨é€™è£¡å¯¦ä½œ
  }

  // TODO: å¯¦ä½œ updateUser æ–¹æ³•
  async updateUser(id: number, userData: UpdateUserRequest): Promise<User> {
    // åœ¨é€™è£¡å¯¦ä½œ
  }

  // TODO: å¯¦ä½œ deleteUser æ–¹æ³•
  async deleteUser(id: number): Promise<void> {
    // åœ¨é€™è£¡å¯¦ä½œ
  }
}`

const exerciseSolution = `interface User {
  id: number;
  name: string;
  email: string;
}

interface CreateUserRequest {
  name: string;
  email: string;
}

interface UpdateUserRequest {
  name?: string;
  email?: string;
}

interface ApiResponse<T> {
  data: T;
  message: string;
  success: boolean;
}

class UserService {
  private apiClient = axios.create({
    baseURL: '/api',
    timeout: 5000,
    headers: {
      'Content-Type': 'application/json'
    }
  });

  constructor() {
    this.setupInterceptors();
  }

  private setupInterceptors() {
    // è«‹æ±‚æ””æˆªå™¨
    this.apiClient.interceptors.request.use(
      (config) => {
        console.log('ç™¼é€è«‹æ±‚:', config.method?.toUpperCase(), config.url);
        return config;
      },
      (error) => {
        console.error('è«‹æ±‚éŒ¯èª¤:', error);
        return Promise.reject(error);
      }
    );

    // éŸ¿æ‡‰æ””æˆªå™¨
    this.apiClient.interceptors.response.use(
      (response) => {
        console.log('æ”¶åˆ°éŸ¿æ‡‰:', response.status, response.config.url);
        return response;
      },
      (error) => {
        this.handleError(error);
        return Promise.reject(error);
      }
    );
  }

  private handleError(error: AxiosError) {
    if (error.response) {
      console.error(\`API éŒ¯èª¤ \${error.response.status}:\`, error.response.data);
    } else if (error.request) {
      console.error('ç¶²è·¯éŒ¯èª¤:', error.request);
    } else {
      console.error('è«‹æ±‚è¨­å®šéŒ¯èª¤:', error.message);
    }
  }

  async getAllUsers(): Promise<User[]> {
    try {
      const response = await this.apiClient.get<ApiResponse<User[]>>('/users');
      return response.data.data;
    } catch (error) {
      console.error('ç²å–ç”¨æˆ¶åˆ—è¡¨å¤±æ•—:', error);
      throw error;
    }
  }

  async getUser(id: number): Promise<User> {
    try {
      const response = await this.apiClient.get<ApiResponse<User>>(\`/users/\${id}\`);
      return response.data.data;
    } catch (error) {
      console.error(\`ç²å–ç”¨æˆ¶ \${id} å¤±æ•—:\`, error);
      throw error;
    }
  }

  async createUser(userData: CreateUserRequest): Promise<User> {
    try {
      const response = await this.apiClient.post<ApiResponse<User>>('/users', userData);
      console.log('ç”¨æˆ¶å‰µå»ºæˆåŠŸ:', response.data.data);
      return response.data.data;
    } catch (error) {
      console.error('å‰µå»ºç”¨æˆ¶å¤±æ•—:', error);
      throw error;
    }
  }

  async updateUser(id: number, userData: UpdateUserRequest): Promise<User> {
    try {
      const response = await this.apiClient.patch<ApiResponse<User>>(\`/users/\${id}\`, userData);
      console.log(\`ç”¨æˆ¶ \${id} æ›´æ–°æˆåŠŸ:\`, response.data.data);
      return response.data.data;
    } catch (error) {
      console.error(\`æ›´æ–°ç”¨æˆ¶ \${id} å¤±æ•—:\`, error);
      throw error;
    }
  }

  async deleteUser(id: number): Promise<void> {
    try {
      await this.apiClient.delete(\`/users/\${id}\`);
      console.log(\`ç”¨æˆ¶ \${id} åˆªé™¤æˆåŠŸ\`);
    } catch (error) {
      console.error(\`åˆªé™¤ç”¨æˆ¶ \${id} å¤±æ•—:\`, error);
      throw error;
    }
  }
}

// ä½¿ç”¨ç¯„ä¾‹
const userService = new UserService();

// æ¸¬è©¦ CRUD æ“ä½œ
async function testUserService() {
  try {
    // ç²å–æ‰€æœ‰ç”¨æˆ¶
    const users = await userService.getAllUsers();
    console.log('æ‰€æœ‰ç”¨æˆ¶:', users);

    // å‰µå»ºæ–°ç”¨æˆ¶
    const newUser = await userService.createUser({
      name: 'John Doe',
      email: 'john@example.com'
    });
    console.log('æ–°ç”¨æˆ¶:', newUser);

    // ç²å–å–®å€‹ç”¨æˆ¶
    const user = await userService.getUser(newUser.id);
    console.log('ç”¨æˆ¶è©³æƒ…:', user);

    // æ›´æ–°ç”¨æˆ¶
    const updatedUser = await userService.updateUser(newUser.id, {
      name: 'John Smith'
    });
    console.log('æ›´æ–°å¾Œç”¨æˆ¶:', updatedUser);

    // åˆªé™¤ç”¨æˆ¶
    await userService.deleteUser(newUser.id);
    console.log('ç”¨æˆ¶å·²åˆªé™¤');

  } catch (error) {
    console.error('æ¸¬è©¦å¤±æ•—:', error);
  }
}`

// æ¼”ç¤ºåŠŸèƒ½
const testGetRequest = async () => {
  loading.value = true
  currentTest.value = 'get'

  try {
    console.log('ğŸ” ç•¶å‰ API é…ç½®:', apiConfig)
    const users = await userAPI.getUsers()
    demoResult.value = `âœ… æˆåŠŸç²å– ${users.length} å€‹ç”¨æˆ¶:\n\n${JSON.stringify(users.slice(0, 3), null, 2)}`
  } catch (error) {
    demoResult.value = `âŒ è«‹æ±‚å¤±æ•—: ${error}\n\nè«‹ç¢ºä¿ JSON Server æ­£åœ¨é‹è¡Œï¼šnpm run json-server`
  } finally {
    loading.value = false
    currentTest.value = ''
  }
}

const testPostRequest = async () => {
  loading.value = true
  currentTest.value = 'post'

  try {
    const newUser = await testAPI.testCreateUser()
    demoResult.value = `âœ… æˆåŠŸå‰µå»ºç”¨æˆ¶:\n\n${JSON.stringify(newUser, null, 2)}`
  } catch (error) {
    demoResult.value = `âŒ å‰µå»ºç”¨æˆ¶å¤±æ•—: ${error}\n\nè«‹ç¢ºä¿ JSON Server æ­£åœ¨é‹è¡Œï¼šnpm run json-server`
  } finally {
    loading.value = false
    currentTest.value = ''
  }
}

const testErrorRequest = async () => {
  loading.value = true
  currentTest.value = 'error'

  try {
    await testAPI.test404()
  } catch (error) {
    demoResult.value = `âœ… æˆåŠŸæ¸¬è©¦éŒ¯èª¤è™•ç†: ${error}`
  } finally {
    loading.value = false
    currentTest.value = ''
  }
}

const testTimeout = async () => {
  loading.value = true
  currentTest.value = 'timeout'

  try {
    await testAPI.testTimeout()
    demoResult.value = 'â±ï¸ è«‹æ±‚å®Œæˆï¼ˆå¯èƒ½æ¯”é æœŸæ…¢ï¼‰'
  } catch (error) {
    demoResult.value = `âœ… è¶…æ™‚æ¸¬è©¦å®Œæˆ: ${error}`
  } finally {
    loading.value = false
    currentTest.value = ''
  }
}

const runBasicConfig = () => {
  demoResult.value = 'Axios å¯¦ä¾‹é…ç½®å®Œæˆï¼æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å°æŸ¥çœ‹è©³ç´°ä¿¡æ¯ã€‚'
}

const runHttpMethod = (method: string) => {
  demoResult.value = `${method.toUpperCase()} æ–¹æ³•ä»£ç¢¼å·²åŸ·è¡Œï¼æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å°æŸ¥çœ‹çµæœã€‚`
}

const runErrorHandling = () => {
  demoResult.value = 'éŒ¯èª¤è™•ç†ä»£ç¢¼å·²è¨­å®šï¼ç¾åœ¨å¯ä»¥å®‰å…¨åœ°è™•ç†å„ç¨® API éŒ¯èª¤ã€‚'
}

onMounted(() => {
  console.log('Axios åŸºç¤ä½¿ç”¨ç« ç¯€å·²è¼‰å…¥')
})
</script>

<style scoped>
.section-content {
  max-width: 1000px;
  margin: 0 auto;
  padding: 2rem;
}

.section-header {
  margin-bottom: 3rem;
  text-align: center;
}

.section-header h2 {
  font-size: 2.5rem;
  font-weight: 700;
  color: #2d3748;
  margin-bottom: 1rem;
}

.section-description {
  font-size: 1.1rem;
  color: #4a5568;
  line-height: 1.6;
  max-width: 600px;
  margin: 0 auto;
}

.content-block {
  margin-bottom: 4rem;
}

.content-block h3 {
  font-size: 1.8rem;
  font-weight: 600;
  color: #2d3748;
  margin-bottom: 1.5rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.intro-card {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 2rem;
  border-radius: 12px;
  margin-bottom: 2rem;
}

.intro-card p {
  font-size: 1.1rem;
  line-height: 1.6;
  margin-bottom: 2rem;
}

.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1.5rem;
}

.feature-item {
  background: rgba(255, 255, 255, 0.1);
  padding: 1.5rem;
  border-radius: 8px;
  text-align: center;
}

.feature-icon {
  font-size: 2rem;
  margin-bottom: 0.5rem;
}

.feature-item h4 {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 0.5rem;
}

.feature-item p {
  font-size: 0.9rem;
  opacity: 0.9;
  margin: 0;
}

.method-tabs {
  background: #fff;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  overflow: hidden;
}

.tab-buttons {
  display: flex;
  background: #f7fafc;
  border-bottom: 1px solid #e2e8f0;
}

.tab-button {
  flex: 1;
  padding: 1rem;
  border: none;
  background: transparent;
  cursor: pointer;
  font-weight: 500;
  color: #4a5568;
  transition: all 0.2s;
}

.tab-button:hover {
  background: #edf2f7;
}

.tab-button.active {
  background: #4299e1;
  color: white;
}

.tab-content {
  padding: 0;
  width: 100%;
  overflow: hidden;
}

.method-description {
  margin-bottom: 1.5rem;
}

.method-description h4 {
  font-size: 1.3rem;
  font-weight: 600;
  color: #2d3748;
  margin-bottom: 0.5rem;
}

.method-description p {
  color: #4a5568;
  line-height: 1.6;
}

.demo-section {
  background: #f7fafc;
  padding: 2rem;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
}

.demo-section h4 {
  font-size: 1.2rem;
  font-weight: 600;
  color: #2d3748;
  margin-bottom: 0.5rem;
}

.demo-section p {
  color: #4a5568;
  margin-bottom: 1.5rem;
}

.api-config-info {
  background: #e3f2fd;
  border: 1px solid #2196f3;
  border-radius: 6px;
  padding: 1rem;
  margin-bottom: 1.5rem;
}

.api-config-info ul {
  margin: 0.5rem 0;
  padding-left: 1.5rem;
}

.api-config-info li {
  margin: 0.25rem 0;
  color: #1976d2;
}

.json-server-note {
  background: #fff3cd;
  border: 1px solid #ffc107;
  border-radius: 4px;
  padding: 0.75rem;
  margin-top: 1rem;
  color: #856404;
}

.json-server-note code {
  background: #f8f9fa;
  padding: 0.2rem 0.4rem;
  border-radius: 3px;
  font-family: 'Monaco', 'Consolas', monospace;
  color: #d63384;
}

.demo-buttons {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  margin-bottom: 1.5rem;
}

.demo-btn {
  padding: 0.75rem 1.5rem;
  background: #4299e1;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 500;
  transition: all 0.2s;
}

.demo-btn:hover:not(:disabled) {
  background: #3182ce;
  transform: translateY(-1px);
}

.demo-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

.demo-result {
  background: #2d3748;
  color: #e2e8f0;
  padding: 1rem;
  border-radius: 6px;
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
}

.demo-result h5 {
  color: #90cdf4;
  margin-bottom: 0.5rem;
  font-family: inherit;
}

.demo-result pre {
  margin: 0;
  white-space: pre-wrap;
  word-break: break-word;
}

.exercise-card {
  background: #fff;
  border: 2px solid #e2e8f0;
  border-radius: 12px;
  padding: 2rem;
}

.exercise-card h4 {
  font-size: 1.3rem;
  font-weight: 600;
  color: #2d3748;
  margin-bottom: 1rem;
}

.exercise-card p {
  color: #4a5568;
  line-height: 1.6;
  margin-bottom: 1rem;
}

.exercise-requirements {
  color: #4a5568;
  margin: 1rem 0 2rem 1rem;
}

.exercise-requirements li {
  margin-bottom: 0.5rem;
}

.start-exercise-btn {
  background: #48bb78;
  color: white;
  border: none;
  padding: 0.75rem 1.5rem;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 500;
  margin: 1rem 0;
  transition: background 0.2s;
}

.start-exercise-btn:hover {
  background: #38a169;
}

.exercise-solution {
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid #e2e8f0;
}

.summary-card {
  background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
  color: white;
  padding: 2rem;
  border-radius: 12px;
}

.summary-card h4 {
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: 1rem;
}

.summary-list {
  margin: 0 0 2rem 1rem;
}

.summary-list li {
  margin-bottom: 0.5rem;
  line-height: 1.5;
}

.next-steps {
  background: rgba(255, 255, 255, 0.1);
  padding: 1.5rem;
  border-radius: 8px;
}

.next-steps h4 {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 0.5rem;
}

.next-steps p {
  margin: 0;
  line-height: 1.6;
  opacity: 0.95;
}

/* æ–°å¢ï¼šå°æ¯”å€å¡Šæ¨£å¼ */
.comparison-intro {
  background: #f0f9ff;
  padding: 1.5rem;
  border-left: 4px solid #0284c7;
  border-radius: 4px;
  margin-bottom: 2rem;
}

.comparison-tabs {
  background: #fff;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  overflow: hidden;
  margin-bottom: 2rem;
  width: 100%;
  max-width: 100%;
}

.comparison-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  padding: 1.5rem;
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  min-height: 400px;
}

.fetch-example,
.axios-example {
  padding: 1rem;
  border-radius: 8px;
  border: 2px solid transparent;
  min-width: 0;
  overflow: hidden;
}

.fetch-example {
  background: #fef2f2;
  border-color: #fca5a5;
}

.axios-example {
  background: #f0fdf4;
  border-color: #86efac;
}

.fetch-example h4,
.axios-example h4 {
  margin-bottom: 1rem;
  font-size: 1.125rem;
  font-weight: 600;
}

.fetch-example h4 {
  color: #dc2626;
}

.axios-example h4 {
  color: #16a34a;
}

/* ä¿®æ­£ CodeBlock åœ¨å°æ¯”å€åŸŸçš„æº¢å‡ºå•é¡Œ */
.fetch-example :deep(.code-block),
.axios-example :deep(.code-block) {
  width: 100%;
  max-width: 100%;
  overflow: hidden;
}

.fetch-example :deep(.code-content),
.axios-example :deep(.code-content) {
  max-width: 100%;
  overflow-x: auto;
  word-break: break-word;
  white-space: pre-wrap;
}

.fetch-example :deep(.code-header),
.axios-example :deep(.code-header) {
  flex-wrap: wrap;
  gap: 0.5rem;
}

.fetch-example :deep(.code-title),
.axios-example :deep(.code-title) {
  font-size: 0.9rem;
  line-height: 1.2;
}

/* æ•ˆç‡åˆ†ææ¨£å¼ */
.metrics-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
  margin-top: 2rem;
}

.metric-card {
  background: white;
  border: 1px solid #e2e8f0;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.metric-card h4 {
  text-align: center;
  margin-bottom: 1.5rem;
  font-size: 1.25rem;
  font-weight: 600;
}

.fetch-metric h4 {
  color: #dc2626;
}

.axios-metric h4 {
  color: #16a34a;
}

.metric-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem 0;
  border-bottom: 1px solid #f3f4f6;
}

.metric-item:last-child {
  border-bottom: none;
}

.metric-label {
  font-weight: 500;
  color: #374151;
}

.metric-value {
  font-weight: 600;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.875rem;
}

.metric-value.high {
  background: #fef2f2;
  color: #dc2626;
}

.metric-value.medium {
  background: #fef3c7;
  color: #d97706;
}

.metric-value.low {
  background: #f0fdf4;
  color: #16a34a;
}

/* C# å°æ¯”æ¨£å¼ */
.csharp-comparison {
  background: #f8fafc;
  padding: 2rem;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
}

.similarity-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
  margin: 2rem 0;
}

.similarity-item {
  background: white;
  padding: 1.5rem;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
}

.similarity-item h4 {
  margin-bottom: 1rem;
  font-size: 1.125rem;
  font-weight: 600;
  color: #2d3748;
}

.similarity-item ul {
  list-style: none;
  margin: 0;
  padding: 0;
}

.similarity-item li {
  padding: 0.5rem 0;
  color: #4a5568;
  border-bottom: 1px solid #f7fafc;
  position: relative;
  padding-left: 1.5rem;
}

.similarity-item li:last-child {
  border-bottom: none;
}

.similarity-item li::before {
  content: "â€¢";
  position: absolute;
  left: 0;
  color: #4299e1;
  font-weight: bold;
}

@media (max-width: 768px) {
  .section-content {
    padding: 1rem;
  }

  .section-header h2 {
    font-size: 2rem;
  }

  .features-grid {
    grid-template-columns: 1fr;
  }

  .tab-buttons {
    flex-direction: column;
  }

  .demo-buttons {
    flex-direction: column;
  }

  .demo-btn {
    width: 100%;
  }

  .comparison-grid,
  .metrics-grid,
  .similarity-grid {
    grid-template-columns: 1fr;
    gap: 1rem;
  }

  .comparison-grid {
    padding: 1rem;
    min-height: auto;
  }

  .fetch-example,
  .axios-example {
    padding: 0.75rem;
  }
}
</style>
